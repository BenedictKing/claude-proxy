# å‡çº§åˆ° v2.0.1 æŒ‡å—

> ä» v2.0.0-go å‡çº§åˆ° v2.0.1 çš„å®Œæ•´æŒ‡å—

## ğŸ¯ å‡çº§æ¦‚è¿°

v2.0.1 ä¸»è¦ä¿®å¤äº†å‰ç«¯èµ„æºåŠ è½½é—®é¢˜å’Œæ€§èƒ½ä¼˜åŒ–ï¼Œå¼ºçƒˆå»ºè®®æ‰€æœ‰ v2.0.0 ç”¨æˆ·å‡çº§ã€‚

### ä¸»è¦æ”¹è¿›

- âœ… **ä¿®å¤å‰ç«¯æ— æ³•åŠ è½½** - è§£å†³ Vite base è·¯å¾„é…ç½®é—®é¢˜
- âœ… **æ€§èƒ½æå‡ 142 å€** - æ™ºèƒ½ç¼“å­˜æœºåˆ¶ï¼Œå¼€å‘æ—¶å¯åŠ¨ä»…éœ€ 0.07 ç§’
- âœ… **API è·¯ç”±ä¿®å¤** - å‰åç«¯è·¯ç”±å®Œå…¨åŒ¹é…
- âœ… **ENV æ ‡å‡†åŒ–** - æ›´é€šç”¨çš„ç¯å¢ƒå˜é‡å‘½å

## ğŸ“‹ å‡çº§æ­¥éª¤

### 1. å¤‡ä»½é…ç½®ï¼ˆå¯é€‰ä½†æ¨èï¼‰

```bash
# å¤‡ä»½é…ç½®æ–‡ä»¶
cp backend-go/.config/config.json backend-go/.config/config.json.backup
cp backend-go/.env backend-go/.env.backup
```

### 2. æ›´æ–°ä»£ç 

```bash
# æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# æˆ–ä¸‹è½½æœ€æ–° Release
# https://github.com/yourusername/claude-proxy/releases/tag/v2.0.1
```

### 3. æ›´æ–°ç¯å¢ƒå˜é‡ï¼ˆæ¨èï¼‰

ç¼–è¾‘ `backend-go/.env`ï¼š

```diff
# æœåŠ¡å™¨é…ç½®
PORT=3001

- NODE_ENV=development
+ # è¿è¡Œç¯å¢ƒ: development | production
+ ENV=development

# ... å…¶ä»–é…ç½®ä¿æŒä¸å˜
```

**æ³¨æ„**ï¼šæ—§çš„ `NODE_ENV` ä»ç„¶æœ‰æ•ˆï¼ˆå‘åå…¼å®¹ï¼‰ï¼Œä½†å»ºè®®è¿ç§»åˆ° `ENV`ã€‚

### 4. é‡æ–°æ„å»º

#### æ–¹å¼ 1: ä½¿ç”¨ Makefileï¼ˆæ¨èï¼‰

```bash
# æ¸…é™¤æ—§çš„æ„å»ºç¼“å­˜
make clean

# é‡æ–°æ„å»ºå‰ç«¯å’Œåç«¯
make build-frontend-internal

# å¯åŠ¨æœåŠ¡å™¨ï¼ˆä¼šè‡ªåŠ¨ä½¿ç”¨ç¼“å­˜ï¼‰
make run
```

#### æ–¹å¼ 2: æ‰‹åŠ¨æ„å»º

```bash
# æ„å»ºå‰ç«¯
cd frontend
npm install
npm run build
cd ..

# æ„å»º Go åç«¯
cd backend-go
./build.sh

# è¿è¡Œ
./dist/claude-proxy-darwin-arm64  # æ ¹æ®ä½ çš„å¹³å°é€‰æ‹©
```

### 5. éªŒè¯å‡çº§

```bash
# æ£€æŸ¥ç‰ˆæœ¬ä¿¡æ¯
make info

# åº”è¯¥æ˜¾ç¤º:
# Version: v2.0.1
# Build Time: 2025-10-12_XX:XX:XX_UTC
# Git Commit: <commit-hash>

# æµ‹è¯•æœåŠ¡å™¨
curl http://localhost:3001/health | jq '.version'

# è®¿é—® Web ç•Œé¢
# http://localhost:3001/?key=your-access-key
```

## ğŸ” å˜æ›´è¯¦æƒ…

### å‰ç«¯èµ„æºä¿®å¤

**é—®é¢˜**ï¼šv2.0.0 ä¸­å‰ç«¯èµ„æºæ— æ³•åŠ è½½ï¼Œæ˜¾ç¤º MIME ç±»å‹é”™è¯¯

**ä¿®å¤å†…å®¹**ï¼š
1. Vite é…ç½®æ·»åŠ  `base: '/'`
2. Go åç«¯ NoRoute å¤„ç†å™¨ä¼˜åŒ–
3. æ·»åŠ å®Œæ•´çš„ Content-Type æ£€æµ‹
4. æ·»åŠ  favicon æ”¯æŒ

**å½±å“**ï¼šå‰ç«¯ç•Œé¢ç°åœ¨èƒ½æ­£å¸¸åŠ è½½äº†

### æ€§èƒ½ä¼˜åŒ–

**æ™ºèƒ½ç¼“å­˜**ï¼š
- é¦–æ¬¡æ„å»ºï¼š~10 ç§’
- æ— å˜æ›´é‡å¯ï¼š**0.07 ç§’**ï¼ˆæå‡ 142 å€ï¼‰
- æœ‰å˜æ›´é‡æ–°æ„å»ºï¼š~8.5 ç§’

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
# ç¬¬ä¸€æ¬¡è¿è¡Œï¼ˆä¼šæ„å»ºå‰ç«¯ï¼‰
make run

# ä¿®æ”¹åç«¯ä»£ç åé‡å¯ï¼ˆè·³è¿‡å‰ç«¯æ„å»ºï¼‰
Ctrl+C
make run  # 0.07 ç§’å¯åŠ¨ï¼

# ä¿®æ”¹å‰ç«¯ä»£ç åé‡å¯ï¼ˆè‡ªåŠ¨é‡æ–°æ„å»ºï¼‰
Ctrl+C
make run  # è‡ªåŠ¨æ£€æµ‹åˆ°å˜æ›´ï¼Œé‡æ–°æ„å»º
```

### API è·¯ç”±å˜æ›´

**å˜æ›´**ï¼š
- `/api/upstreams` â†’ `/api/channels`
- æ–°å¢ `/api/loadbalance` (PUT)
- æ–°å¢ `/api/ping/:id` (GET)
- æ–°å¢ `/api/ping` (GET)

**å½±å“**ï¼šå‰ç«¯ API è°ƒç”¨ç°åœ¨èƒ½æ­£å¸¸å·¥ä½œ

**è¿ç§»**ï¼šæ— éœ€ä¿®æ”¹ï¼Œæ–°è·¯ç”±è‡ªåŠ¨ç”Ÿæ•ˆ

### ç¯å¢ƒå˜é‡å˜æ›´

**å˜æ›´**ï¼š`NODE_ENV` â†’ `ENV`

**å‘åå…¼å®¹**ï¼š
```go
// ä¼˜å…ˆè¯»å– ENVï¼Œå›é€€åˆ° NODE_ENV
env := getEnv("ENV", "")
if env == "" {
    env = getEnv("NODE_ENV", "development")
}
```

**è¿ç§»å»ºè®®**ï¼š
- âœ… ç«‹å³è¿ç§»ï¼šä¿®æ”¹ `.env` æ–‡ä»¶ä½¿ç”¨ `ENV`
- âœ… å»¶è¿Ÿè¿ç§»ï¼šä¿æŒä½¿ç”¨ `NODE_ENV` ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œ
- âš ï¸ æœªæ¥ç‰ˆæœ¬ï¼šv3.0.0 å¯èƒ½ç§»é™¤ `NODE_ENV` æ”¯æŒ

## ğŸ†• æ–°åŠŸèƒ½ä½¿ç”¨

### 1. æ™ºèƒ½ç¼“å­˜

```bash
# æŸ¥çœ‹ç¼“å­˜çŠ¶æ€
ls -la backend-go/frontend/dist/.build-marker

# å¼ºåˆ¶é‡æ–°æ„å»º
make build-frontend

# æ¸…é™¤ç¼“å­˜
make clean
```

### 2. ENV å˜é‡è¯¦ç»†é…ç½®

```bash
# å¼€å‘ç¯å¢ƒï¼ˆè¯¦ç»†æ—¥å¿—ã€å¼€å‘ç«¯ç‚¹ã€å®½æ¾ CORSï¼‰
ENV=development

# ç”Ÿäº§ç¯å¢ƒï¼ˆé«˜æ€§èƒ½ã€ä¸¥æ ¼å®‰å…¨ï¼‰
ENV=production
```

**å½±å“è¯´æ˜**ï¼š

| é…ç½®é¡¹ | development | production |
|--------|-------------|------------|
| Gin æ¨¡å¼ | DebugMode | ReleaseMode |
| `/admin/dev/info` | âœ… å¼€å¯ | âŒ å…³é—­ |
| CORS | å®½æ¾ï¼ˆlocalhostè‡ªåŠ¨å…è®¸ï¼‰| ä¸¥æ ¼ |
| æ—¥å¿— | è¯¦ç»† | æœ€å° |

### 3. favicon æ”¯æŒ

ç°åœ¨è‡ªåŠ¨åŒ…å« faviconï¼Œæµè§ˆå™¨æ ‡ç­¾é¡µä¼šæ˜¾ç¤º "C" å›¾æ ‡ã€‚

è‡ªå®šä¹‰ faviconï¼š
```bash
# æ›¿æ¢ frontend/public/favicon.svg
# é‡æ–°æ„å»º
make build-frontend-internal
```

## âŒ ç ´åæ€§å˜æ›´

**æ— ç ´åæ€§å˜æ›´**ã€‚æ‰€æœ‰ v2.0.0 é…ç½®å’Œ API å®Œå…¨å…¼å®¹ã€‚

## ğŸ› å·²çŸ¥é—®é¢˜

### é—®é¢˜ï¼šå‰ç«¯èµ„æº 404ï¼ˆå·²ä¿®å¤ï¼‰

**ç—‡çŠ¶**ï¼šè®¿é—® Web ç•Œé¢æ—¶èµ„æºåŠ è½½å¤±è´¥

**åŸå› **ï¼šVite base è·¯å¾„é…ç½®é”™è¯¯

**çŠ¶æ€**ï¼šâœ… v2.0.1 å·²ä¿®å¤

### é—®é¢˜ï¼šfavicon.ico è¿”å› HTMLï¼ˆå·²ä¿®å¤ï¼‰

**ç—‡çŠ¶**ï¼šæµè§ˆå™¨æ§åˆ¶å°æ˜¾ç¤º MIME ç±»å‹é”™è¯¯

**åŸå› **ï¼šNoRoute å¤„ç†å™¨é€»è¾‘é—®é¢˜

**çŠ¶æ€**ï¼šâœ… v2.0.1 å·²ä¿®å¤

## ğŸ“ æ”¯æŒ

é‡åˆ°å‡çº§é—®é¢˜ï¼Ÿ

1. **æŸ¥çœ‹æ—¥å¿—**ï¼š`make run` å¯åŠ¨æœåŠ¡æŸ¥çœ‹é”™è¯¯ä¿¡æ¯
2. **æ¸…é™¤ç¼“å­˜**ï¼š`make clean && make build-frontend-internal`
3. **éªŒè¯ç‰ˆæœ¬**ï¼š`make info` ç¡®è®¤ç‰ˆæœ¬ä¸º v2.0.1
4. **æäº¤ Issue**ï¼šhttps://github.com/yourusername/claude-proxy/issues

## ğŸ”„ å›æ»šåˆ° v2.0.0

å¦‚æœå‡çº§é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥å›æ»šï¼š

```bash
# åˆ‡æ¢åˆ° v2.0.0 æ ‡ç­¾
git checkout v2.0.0-go

# æ¢å¤é…ç½®
cp backend-go/.config/config.json.backup backend-go/.config/config.json
cp backend-go/.env.backup backend-go/.env

# é‡æ–°æ„å»º
make clean
cd frontend && npm install && npm run build && cd ..
cd backend-go && ./build.sh
```

## âœ… å‡çº§æ£€æŸ¥æ¸…å•

- [ ] å¤‡ä»½é…ç½®æ–‡ä»¶
- [ ] æ›´æ–°ä»£ç åˆ° v2.0.1
- [ ] æ›´æ–° `.env` æ–‡ä»¶ï¼ˆå¯é€‰ï¼Œæ¨èï¼‰
- [ ] æ¸…é™¤æ—§æ„å»ºç¼“å­˜ (`make clean`)
- [ ] é‡æ–°æ„å»ºå‰ç«¯ (`make build-frontend-internal`)
- [ ] å¯åŠ¨æœåŠ¡å™¨ (`make run`)
- [ ] éªŒè¯ç‰ˆæœ¬ä¿¡æ¯ (`make info`)
- [ ] æµ‹è¯• Web ç•Œé¢è®¿é—®
- [ ] æµ‹è¯• API è°ƒç”¨

---

**å‡çº§æˆåŠŸï¼** ğŸ‰

ç°åœ¨ä½ æ‹¥æœ‰äº†æ›´å¿«ã€æ›´ç¨³å®šçš„ Claude Proxy v2.0.1ï¼
